# Lab - Python and Grove Sensors

Python · Grove Sensors · Sensor Readings



## Introduction 

In this lab you’ll get hands-on with Python by using it to read real sensors and control hardware on a Raspberry Pi. Instead of working with made-up values, your programs will measure temperature, humidity, light levels, and motion, and respond to button presses and LEDs using Grove modules. As you work through the tasks, you’ll practice key Python features covered in our classes like variables, `if` statements, loops, functions, lists, dictionaries, and file logging, and see how they fit together in real programs. By the end of the lab, you should feel more confident writing Python code that does something physical and useful, not just prints to the screen.

### Prerequisites:

Do this lab:https://tutors.dev/lab/setu-iot-protocols-2026/topic-01/unit-1/book-1

### Task - setup

You should have a Grove Base Kit

1. If you khaven't already, connect the Grove base hat to your Pi. The socket on the hat fits over all of the GPIO pins on the Pi, sliding all the way down the pins to sit firmly on the base. It sits over the Pi, covering it.

    ![Fitting the grove hat](./img/pi-grove-hat-fitting.gif)

2. Connect the following modules to the Grove base hat as indicated below. You should be able to identify the port on the Grove HAT

    **DHT11** → **D5**

    **Mini PIR** → **D16**

    **Red LED Button** → **D18**

    **Light Sensor** → **A0**

### Task 1 - Read Sensor Values  (variables + f-strings)

In this task you’ll write a simple Python program that reads data from the temperature, humidity, light, and motion sensors and prints the values to the screen. The goal is to get comfortable with variables and formatted output (`f-strings`) while checking that your hardware and software are working correctly.

1. In the same folder as your previous lab (sensors), create `read_sensors.py` and paste in the following code:

~~~python
# DHT11 (digital)
from seeed_dht import DHT

# For Light sensor (analog via Base HAT ADC)
from grove.adc import ADC

# PIR motion sensor (digital)
from grove.gpio import GPIO

adc = ADC(0x08)
# ---- Port selections (edit if you wired differently) ----
DHT_PIN = 5       # D5
PIR_PIN = 16      # D16
LIGHT_CHANNEL = 0 # A0 -> channel 0


def read_dht11():
    dht = DHT("11", DHT_PIN)
    humidity, temperature = dht.read()
    return temperature, humidity


def read_light():
    light = adc.read(0)
    return light


def read_pir():
    pir = GPIO(PIR_PIN, GPIO.IN)
    return pir.read()  # 1 = motion, 0 = no motion


if __name__ == "__main__":
    temp, hum = read_dht11()
    light_level = read_light()
    motion = read_pir()

    print(f"Temperature: {temp} °C")
    print(f"Humidity:    {hum} %")
    print(f"Light:       {light_level}")
    print(f"Motion:      {motion}")
~~~

2. As in the last lab, enable the Python virtual environment before running th script as shown below:

   ~~~cmd
   source ./.venv/bin/activate
   python read_sensors.py
   ~~~

   you should see the following output with different values:

   ~~~cmd
   Temperature: 17 °C
   Humidity:    59 %
   Light:       510
   Motion:      0
   ~~~

   

### Task 2: Conditionals , thresholds and custom modules

Here you’ll use `if` and `else` statements to make decisions based on sensor values. For example, your program will decide whether it is “bright” or “dim” based on a light threshold entered by the user, and whether motion has been detected. you will also import and reuse the code from the previous task.

1. In the same folder, create  `thresholds.py` with the following content:

~~~python
import read_sensors

def classify_light(light_value, threshold):
    if light_value >= threshold:
        return "bright"
    else:
        return "dim"

def motion_message(motion_value):
    if motion_value == 1:
        return "Motion detected!"
    else:
        return "No motion."

if __name__ == "__main__":
    threshold_str = input("Enter a light threshold (e.g., 200): ")
    threshold = int(threshold_str)

    humidity, temperature = read_sensors.read_dht11()
    light_value =read_sensors.read_light()
    motion_value = read_sensors.read_pir()

    print(f"Temp: {temperature} °C | Humidity: {humidity} %")
    print(f"Light: {light_value} => {classify_light(light_value, threshold)}")
    print(motion_message(motion_value))
~~~

Notice how we are importing the read_sensors module and using it to access the sensor values. 

2. Run the script and enter a threshold to test it

   ~~~cmd
   python thresholds.py
   ~~~

### Task 3 Loops + lists (sampling over time)

In this section you’ll collect sensor readings over time using loops. You’ll store multiple readings in lists and calculate average values, which helps you see how loops and collections are used for handling repeated data.

Create `sample_loop.py` with the following code:

~~~python
from  read_sensors import read_dht11,read_light, read_pir 
import time

if __name__ == "__main__":
    samples = int(input("How many samples? (e.g., 10): "))
    delay = float(input("Delay between samples in seconds? (e.g., 1): "))

    temps = []
    hums = []
    lights = []

    for i in range(samples):
        humidity, temperature = read
        light_value = light.light

        temps.append(temperature)
        hums.append(humidity)
        lights.append(light_value)

        print(f"[{i+1}/{samples}] T={temperature}°C H={humidity}% L={light_value}")
        time.sleep(delay)

    print("\n--- Averages ---")
    print(f"Avg temp:  {average(temps):.2f} °C")
    print(f"Avg hum:   {average(hums):.2f} %")
    print(f"Avg light: {average(lights):.2f}")
~~~

### Task 4 – Organising data with dictionaries

This part introduces dictionaries by grouping all sensor readings into a single “snapshot” of data. Instead of keeping lots of separate variables, you’ll store related values together in a structured and readable way.

Create a file called `snapshot_dict.py`:

~~~python
from  read_sensors import read_dht11,read_light, read_pir 
import time

def get_snapshot():
    light = read_light()
    pir = read_pir()
    humidity, temperature = read_dht11()
    
	# Return a dictionary with all sensor readings and a timestamp
    return {
        "timestamp": time.strftime("%Y-%m-%d %H:%M:%S"),
        "temperature_c": temperature,
        "humidity_pct": humidity,
        "light": light,
        "motion": pir
    }

if __name__ == "__main__":
    snap = get_snapshot()
    print(f"Snapshot @ {snap['timestamp']}")
    print(f"  Temp:   {snap['temperature_c']} °C")
    print(f"  Hum:    {snap['humidity_pct']} %")
    print(f"  Light:  {snap['light']}")
    print(f"  Motion: {snap['motion']}")
~~~





### Task 5 – Logging data to a file

Here you’ll save sensor readings to a file on the Raspberry Pi. You’ll practise working with files in Python and create a CSV log that can later be opened in a spreadsheet or used for data analysis.

Create `logger.py`:

~~~python
from  read_sensors import read_dht11,read_light, read_pir 
import time
LOG_FILE = "sensor_log.csv"

if __name__ == "__main__":
    samples = int(input("How many log lines? (e.g., 20): "))
    delay = float(input("Seconds between logs? (e.g., 2): "))

    for _ in range(samples):
        timestamp = time.strftime("%Y-%m-%d %H:%M:%S")
        humidity, temperature = read_dht11()
        light = read_light()
        motion = read_pir()

        line = f"{timestamp},{temperature},{humidity},{light},{motion}\n"
        with open(LOG_FILE, "a") as f:
            f.write(line)

        print(f"Logged: {line.strip()}")
        time.sleep(delay)

    print(f"\nDone. Open {LOG_FILE} to view your data.")
~~~

### Task 6 - Sending data over the network

Send a sensor reading to a web service using an HTTP request. This shows how Python can move data beyond the Raspberry Pi and connect to external services and APIs.

Create `post_snapshot.py`:

```python
import requests
from snapshot_dict import get_snapshot

if __name__ == "__main__":
    snap = get_snapshot()
    r = requests.post("https://httpbin.org/post", json=snap, timeout=10)
    data = r.json()

    print("Server received JSON:")
    print(data["json"])
```
