# Measure temperature - Raspberry Pi

In this part of the lesson, you will add a temperature sensor to your Raspberry Pi.

## Hardware

The sensor you'll use is a [DHT11 humidity and temperature sensor](https://www.seeedstudio.com/Grove-Temperature-Humidity-Sensor-DHT11.html), combining 2 sensors in one package. This is fairly popular, with a number of commercially available sensors combining temperature, humidity and sometimes atmospheric pressure. The temperature sensor component is a negative temperature coefficient (NTC) thermistor, a thermistor where the resistance decreases as the temperature increases.

This is a digital sensor, so has an onboard ADC to create a digital signal containing the temperature and humidity data that the microcontroller can read.

### Connect the temperature sensor

The Grove temperature sensor can be connected to the Raspberry Pi.

#### Task

Connect the temperature sensor

![A grove temperature sensor](./img/02.02/grove-dht11.png)

1. Insert one end of a Grove cable into the socket on the humidity and temperature sensor. It will only go in one way round.

1. With the Raspberry Pi powered off, connect the other end of the Grove cable to the digital socket marked **D5** on the Grove Base hat attached to the Pi. This socket is the second from the left, on the row of sockets next to the GPIO pins.

![The grove temperature sensor connected to socket A0](./img/02.02/pi-temperature-sensor.png)

## Program the temperature sensor

The device can now be programmed to use the attached temperature sensor.

### Task

Program the device.

1. Make sure the RPi is on and wait for it to boot

1. Launch VS Code and connect via the Remote SSH extension(or just use command line if you're into that kind of thing!).

   > âš ï¸ You can refer to the previous step for VS Code connection instruction

1. Create a ``sensors`` folder in the home directory on the RPi and open a command line prompt in it.

### Pip and Python Virtual Environments

One of the powerful features of Python is the ability to install [Pip packages](https://pypi.org/) - these are packages of code written by other people and published to the Internet. You can install a Pip package onto your computer with one command, then use that package in your code. Youâ€™ll be using Pip to install a package to talk to your grove sensors.

By default when you install a package it is available everywhere on your computer, and this can lead to problems with package versions - such as one application depending on one version of a package that breaks when you install a new version for a different application. To work around this problem, you can use a [Python virtual environment](https://docs.python.org/3/library/venv.html), essentially a copy of Python in a dedicated folder, and when you install Pip packages they get installed just to that folder.

#### Python virtual environment

Configure a Python virtual environment and install the Pip packages.

1. Run the following in the `sensors` folder(open an integrated terminal window in VS Code). This will  create a virtual environment in the `.venv` folder

```
python -m venv --system-site-packages .venv
```

The `--system-site-packages` option ensures that system packages installed on your raspberry Pi are available in the virtual environment. The particular package we will need is the one for SenseHat.

2. Activate the virtual environment:

```
source ./.venv/bin/activate
```

ðŸ’ This should be run from the same location you ran the command to create the virtual environment. **You will never need to navigate into the `.venv` folder**, you should always run the activate command and any commands to install packages or run code from the folder you were in when you created the virtual environment.

4. Once the virtual environment has been activated(you should see `(.venv)` at the front of your prompt), the default `python` command will run the version of Python that was used to create the virtual environment. Run the following to get the version:

```
python --version
```

The output should contain similar the following(with your used name instead of frank):

```
(.venv) frank@frankRpi:~/sensor $ python --version
Python 3.13.5
```

ðŸ’ Your Python version may be different - as long as itâ€™s version 3.13 or higher you are good to go!

5. Once you have your virtual environment up and running , run the following **in the sensors folder** to install all the needed libraries for the Grove hardware:

```sh
git clone https://github.com/Seeed-Studio/grove.py
cd grove.py
pip install .

sudo raspi-config nonint do_i2c 0
```

One of the powerful features of Python is the ability to install [Pip packages](https://pypi.org) - these are packages of code written by other people and published to the Internet. You can install a Pip package onto your computer with one command, then use that package in your code.

The Seeed Grove Python packages need to be installed from source. These commands will clone the repo containing the source code for this package, then install it locally.

1. To use the temperature and humidity sensor, an additional Pip package needs to be installed. From the Terminal in VS Code, run the following command to install this Pip package on the Pi:

   ```sh
   pip install seeed-python-dht
   ```

1. Add the following code to the `app.py` file to import the required libraries:

   ```python
   import time
   from seeed_dht import DHT
   ```

   The `from seeed_dht import DHT` statement imports the `DHT` sensor class to interact with a Grove temperature sensor from the `seeed_dht` module.

1. Add the following code after the code above to create an instance of the class that manages the temperature sensor:

   ```python
   sensor = DHT("11", 5)
   ```

   This declares an instance of the `DHT` class that manages the **D**igital **H**umidity and **T**emperature sensor. The first parameter tells the code the sensor being used is the *DHT11* sensor - the library you are using supports other variants of this sensor. The second parameter tells the code the sensor is connected to digital port `D5` on the Grove base hat.

   > âœ… Remember, all the sockets have unique pin numbers. Pins 0, 2, 4, and 6 are analog pins, pins 5, 16, 18, 22, 24, and 26 are digital pins.

1. Add an infinite loop after the code above to poll the temperature sensor value and print it to the console:

   ```python
   while True:
       _, temp = sensor.read()
       print(f'Temperature {temp}Â°C')
   ```

   The call to `sensor.read()` returns a tuple of humidity and temperature. You only need the temperature value, so the humidity is ignored. The temperature value is then printed to the console.

1. Add a small sleep of ten seconds at the end of the `loop` as the temperature levels don't need to be checked continuously. A sleep reduces the power consumption of the device.

   ```python
   time.sleep(5)
   ```

1. From the VS Code Terminal, run the following to run your Python app:

   ```sh
   python app.py
   ```

   You should see temperature values being output to the console. Use something to warm the sensor, such as pressing your thumb on it, or using a fan to see the values change:

   ```output
   (.venv) frank@rpifrank:~/temperature-sensor $ python app.py
   Temperature 25Â°C
   Temperature 23Â°C
   Temperature 23Â°C
   Temperature 23Â°C
   Temperature 23Â°C
   Temperature 23Â°C
   ```

ðŸ˜€ Your temperature sensor program is up and running!